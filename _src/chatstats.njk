---
layout: base.njk
eleventyNavigation:
  key: Chat Stats
  order: 3
---

{% include "nav.njk" %}

<section class="mb-5">
  <div class="content">
    <h3 class="heading">Chat Stats</h3>

    <h4>Username colors</h4>
    <div id="chart"></div>

  </div>
</section>

<script src="https://unpkg.com/d3@7.8.4/dist/d3.min.js"></script>

<script>
  // greets https://stackoverflow.com/a/71422140/1004931
  d3.json('/js/colors.json').then((fetchedData) => {

    const colors = fetchedData?.colors

    const width = 700,
          height = 500;

    const svg = d3.select("#chart").append("svg")
      .attr("width", width)
      .attr("height", height);

    const x = d3.scalePoint()
      .domain(colors.map(d => d.date))
      .range([30, width-30]);
    svg.append("g")
      .attr("transform", `translate(0, ${height-30})`)
      .call(d3.axisBottom(x).ticks(5));
    const y = d3.scaleLinear()
      .domain([0, d3.max(colors, d => d.count)])
      .range([height-30, 0]);
    svg.append("g")
      .attr("transform", `translate(30, 0)`)
      .call(d3.axisLeft(y));
        
    const dataNest = Array.from(
      d3.group(colors, d => d.color), ([key, value]) => ({ key, value })
    );
    const line = d3.line()
      .x(d => x(d.date))
      .y(d => y(d.count));
    svg.selectAll("path.line")
      .data(dataNest)
      .join("path")
        .attr("class", "line")
        .attr("fill", "none")
        .attr("stroke-width", '5px')
        .style("stroke", d => d.key === '' ? 'black' : d.key)
        .attr("d", d => line(d.value));

      })
</script>


<script src="/js/ntc.js"></script>